# Лабораторная работа 3

## Задача

Реализовать упрощённую [Модель песчаной кучи](https://en.wikipedia.org/wiki/Abelian_sandpile_model), позволяющую сохранять свои состояния в картинку в [формате BMP](https://en.wikipedia.org/wiki/BMP_file_format).

Изначальное состояние и размер сетки задаются.

Размер сетки может изменяться в процессе*.

Реализация — консольное приложение, поддерживающее следующие аргументы командной строки:

**-l, --length**   - длина сетки (гарантированно влезет в uint16_t)

**-w, --width**    - ширина сетки (гарантированно влезет в uint16_t)

**-i, --input**    - tsv-файл (tab-separated values) c начальными данными

**-o, --output**   - путь к директории, для сохранения картинок

**-m, --max-iter** - максимальное количество итераций модели

**-f, --freq**     - частота, с которой должны сохранятся картинки (если 0, то сохраняется только последнее состояние)

## Начальное состояние

Начальное состояние задаётся размерами сетки, переданными в качестве аргументов программы, и файлом с изначальным количеством песчинок в каждой ячейке, кроме пустых.

Формат файла:
Каждая строчка содержит информацию об одной ячейке, в виде (x-координата, y-координата, количество песчинок), разделённых символом табуляции. Количество песчинок гарантированно влезет в uint64_t.

## Примечания к модели

1. Новые песчинки добавляются только при инициализации.

2. Состояние следующего поколения ячеек зависит только от предыдущего состояния сетки.

3. В случае если песчинки обваливаются за сетку, они пропадают. / В случае если песчинки обваливаются за сетку, её размер увеличивается на 1 в соответствующую сторону*.

## Результат работы программа

Программа должна пересчитывать состояние модели согласно начальным данным, а также сохранять промежуточные состояния с заданной частотой в картинку в формате bmp.

Картинка для текущего состояния формируется по след правилам:

1. Размер картинки равен размеру поля

2. Каждый пиксель соответствует ячейке поля

3. Цвет пикселя зависит от количества песчинок в ячейке: 0 - белый, 1 - зеленый, 2 - фиолетовый, 3 - желтый, > 3 - черный.

Программа должна закончить свою работу в случае, если модель достигла стабильного состояния, либо номер итерации достиг заданного изначально.

## Примечание

1. Для реализации Вам может пригодиться [библиотека](https://en.cppreference.com/w/cpp/filesystem) для работы с файловой системы из стандартной библиотеки.
2. Пользоваться сторонними библиотеками запрещено. Это в частности означает, что вы должны сами спроектировать и реализовать функции для работы с картинками в формате bmp.
3. В данной лабе вам дано только описание, структура проекта, и организация сборки — так же ваша задача.

## Deadline

1. 30.10.22 24:00 - 0.8
2. 06.11.22 24:00 - 0.65
3. 13.11.22 24:00 - 0.5

## NB

Данная оценивается 15 баллами, первый дедлайн через 3 недели.




  